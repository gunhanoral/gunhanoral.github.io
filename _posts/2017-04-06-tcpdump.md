---
layout: post
title:  "Tcpdump cheatsheet"
description:
date:   2017-04-04 22:32:06
categories: network
tags:
  - data
  - ip
  - frame
  - ethernet
  - wireshark
  - Protocols
  - featured
image: /assets/article_images/2017-04-05-udp-nedir/background.jpg
published: false
---


Standart bir çıktı:

```
root@ip-172-31-22-143:~# tcpdump -c 10
```

```
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
11:19:19.723525 IP ip-172-31-22-143.eu-central-1.compute.internal.ssh > x.x.x.x.dsl.static.turk.net.10816: Flags [P.], seq 2110708016:2110708144, ack 3242368622, win 284, length 128
11:19:19.723556 IP ip-172-31-22-143.eu-central-1.compute.internal.ssh > x.x.x.x.dsl.static.turk.net.10816: Flags [P.], seq 128:192, ack 1, win 284, length 64
11:19:19.723589 IP ip-172-31-22-143.eu-central-1.compute.internal.ssh > x.x.x.x.dsl.static.turk.net.10816: Flags [P.], seq 192:320, ack 1, win 284, length 128
11:19:19.723616 IP ip-172-31-22-143.eu-central-1.compute.internal.ssh > x.x.x.x.dsl.static.turk.net.10816: Flags [P.], seq 320:384, ack 1, win 284, length 64
11:19:19.723816 IP ip-172-31-22-143.eu-central-1.compute.internal.44612 > ip-172-31-0-2.eu-central-1.compute.internal.domain: 1049+ PTR? x.x.x.x.in-addr.arpa. (43)
11:19:19.724395 IP ip-172-31-0-2.eu-central-1.compute.internal.domain > ip-172-31-22-143.eu-central-1.compute.internal.44612: 1049 1/0/0 PTR x.x.x.x.dsl.static.turk.net. (89)
11:19:19.724459 IP ip-172-31-22-143.eu-central-1.compute.internal.54409 > ip-172-31-0-2.eu-central-1.compute.internal.domain: 54794+ PTR? 143.22.31.172.in-addr.arpa. (44)
11:19:19.725335 IP ip-172-31-22-143.eu-central-1.compute.internal.ssh > x.x.x.x.dsl.static.turk.net.10816: Flags [P.], seq 688:976, ack 1, win 284, length 288
11:19:19.725360 IP ip-172-31-22-143.eu-central-1.compute.internal.ssh > x.x.x.x.dsl.static.turk.net.10816: Flags [P.], seq 976:1200, ack 1, win 284, length 224
11:19:19.725388 IP ip-172-31-22-143.eu-central-1.compute.internal.ssh > x.x.x.x.dsl.static.turk.net.10816: Flags [P.], seq 1200:1264, ack 1, win 284, length 64
10 packets captured
15 packets received by filter
4 packets dropped by kernel
```

Sadece ICMP paketleri:
```
root@ip-172-31-22-143:~# tcpdump icmp
```
CTRL + C ile sonlandırabilirsiniz.

```
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes

11:24:28.449759 IP 18.178.70.95.dsl.static.turk.net > ip-172-31-22-143.eu-central-1.compute.internal: ICMP echo request, id 1, seq 7, length 40
11:24:28.449784 IP ip-172-31-22-143.eu-central-1.compute.internal > 18.178.70.95.dsl.static.turk.net: ICMP echo reply, id 1, seq 7, length 40
11:24:29.451953 IP 18.178.70.95.dsl.static.turk.net > ip-172-31-22-143.eu-central-1.compute.internal: ICMP echo request, id 1, seq 8, length 40
11:24:29.451977 IP ip-172-31-22-143.eu-central-1.compute.internal > 18.178.70.95.dsl.static.turk.net: ICMP echo reply, id 1, seq 8, length 40
11:24:30.458596 IP 18.178.70.95.dsl.static.turk.net > ip-172-31-22-143.eu-central-1.compute.internal: ICMP echo request, id 1, seq 9, length 40
11:24:30.458616 IP ip-172-31-22-143.eu-central-1.compute.internal > 18.178.70.95.dsl.static.turk.net: ICMP echo reply, id 1, seq 9, length 40
11:24:31.458729 IP 18.178.70.95.dsl.static.turk.net > ip-172-31-22-143.eu-central-1.compute.internal: ICMP echo request, id 1, seq 10, length 40
11:24:31.458752 IP ip-172-31-22-143.eu-central-1.compute.internal > 18.178.70.95.dsl.static.turk.net: ICMP echo reply, id 1, seq 10, length 40
```

Sadece 8.8.8.8

```
root@ip-172-31-22-143:~# tcpdump host 8.8.8.8
```

```
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes

11:27:26.104170 IP ip-172-31-22-143.eu-central-1.compute.internal > google-public-dns-a.google.com: ICMP echo request, id 9008, seq 1, length 64
11:27:26.126807 IP google-public-dns-a.google.com > ip-172-31-22-143.eu-central-1.compute.internal: ICMP echo reply, id 9008, seq 1, length 64
11:27:27.106083 IP ip-172-31-22-143.eu-central-1.compute.internal > google-public-dns-a.google.com: ICMP echo request, id 9008, seq 2, length 64
11:27:27.128748 IP google-public-dns-a.google.com > ip-172-31-22-143.eu-central-1.compute.internal: ICMP echo reply, id 9008, seq 2, length 64
11:27:28.108031 IP ip-172-31-22-143.eu-central-1.compute.internal > google-public-dns-a.google.com: ICMP echo request, id 9008, seq 3, length 64
11:27:28.130660 IP google-public-dns-a.google.com > ip-172-31-22-143.eu-central-1.compute.internal: ICMP echo reply, id 9008, seq 3, length 64
11:27:29.109938 IP ip-172-31-22-143.eu-central-1.compute.internal > google-public-dns-a.google.com: ICMP echo request, id 9008, seq 4, length 64
11:27:29.132553 IP google-public-dns-a.google.com > ip-172-31-22-143.eu-central-1.compute.internal: ICMP echo reply, id 9008, seq 4, length 64
```


```
root@ip-172-31-22-143:~# tcpdump -ttttnnvv icmp
```

```
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
2017-05-01 11:51:54.949377 IP (tos 0x0, ttl 119, id 21024, offset 0, flags [none], proto ICMP (1), length 60)
    95.70.178.18 > 172.31.22.143: ICMP echo request, id 1, seq 19, length 40
2017-05-01 11:51:54.949404 IP (tos 0x0, ttl 64, id 31385, offset 0, flags [none], proto ICMP (1), length 60)
    172.31.22.143 > 95.70.178.18: ICMP echo reply, id 1, seq 19, length 40
2017-05-01 11:51:55.949765 IP (tos 0x0, ttl 119, id 21029, offset 0, flags [none], proto ICMP (1), length 60)
    95.70.178.18 > 172.31.22.143: ICMP echo request, id 1, seq 20, length 40
2017-05-01 11:51:55.949794 IP (tos 0x0, ttl 64, id 31403, offset 0, flags [none], proto ICMP (1), length 60)
    172.31.22.143 > 95.70.178.18: ICMP echo reply, id 1, seq 20, length 40
2017-05-01 11:51:56.953621 IP (tos 0x0, ttl 119, id 21034, offset 0, flags [none], proto ICMP (1), length 60)
    95.70.178.18 > 172.31.22.143: ICMP echo request, id 1, seq 21, length 40
2017-05-01 11:51:56.953642 IP (tos 0x0, ttl 64, id 31541, offset 0, flags [none], proto ICMP (1), length 60)
    172.31.22.143 > 95.70.178.18: ICMP echo reply, id 1, seq 21, length 40
2017-05-01 11:51:57.956751 IP (tos 0x0, ttl 119, id 21038, offset 0, flags [none], proto ICMP (1), length 60)
    95.70.178.18 > 172.31.22.143: ICMP echo request, id 1, seq 22, length 40
2017-05-01 11:51:57.956774 IP (tos 0x0, ttl 64, id 31780, offset 0, flags [none], proto ICMP (1), length 60)
    172.31.22.143 > 95.70.178.18: ICMP echo reply, id 1, seq 22, length 40

```

* t veya tttt : Paketlerin zaman bilgisini okunabilir hale getiriyor. t sayısı arttıkça daha okunaklı hale geliyor.
* n ve nn: n hostname'leri çözmemeyi sağlarken nn hostname'leri ve portları çözmeyi engelliyor.
* v, vv, vvv: Paket detay bilgilerini göstermeyi sağlarken

diğer seçenekler:

* -i any : Listen on all interfaces just to see if you’re seeing any traffic.
* -i eth0 : Listen on the eth0 interface.
* -D : Show the list of available interfaces
* -n : Don’t resolve hostnames.
* -nn : Don’t resolve hostnames or port names.
* -q : Be less verbose (more quiet) with your output.
* -t : Give human-readable timestamp output.
* -tttt : Give maximally human-readable timestamp output.
* -X : Show the packet’s contents in both hex and ASCII.
* -XX : Same as -X, but also shows the ethernet header.
* -v, -vv, -vvv : Increase the amount of packet information you get back.
* -c : Only get x number of packets and then stop.
* -s : Define the snaplength (size) of the capture in bytes. Use -s0 to get everything, unless you are intentionally capturing less.
* -S : Print absolute sequence numbers.
* -e : Get the ethernet header as well.
* -q : Show less protocol information.
* -E : Decrypt IPSEC traffic by providing an encryption key.
